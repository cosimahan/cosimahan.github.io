<!DOCTYPE html><html><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.png"><link rel="alternate" type="application/rss+xml" title="Cosima Han's" href="http://blog.cosimahan.com/atom.xml"><link rel="stylesheet" href="/styles.css"><title>对某种射频卡的简单安全探究 | Cosima Han's</title></head><body><div class="container"><div class="columns page-header"><h1>Cosima Han's</h1></div><div class="columns"><div class="navigation clearfix"><nav class="left"><a href="/">主页</a><a href="https://github.com/cosimahan">GitHub</a><a href="/about">关于</a><a href="/messageboard">留言板</a></nav><nav class="right"><a href="/atom.xml">RSS</a></nav></div></div><div class="columns"><div class="block-body column three-fourths"><article><header><small class="right"><!--a(target='_blank', href=sourceOfPost(post, theme.source_url)) 查看源代码--></small><h2>对某种射频卡的简单安全探究</h2></header><div class="article-meta clearfix"><time class="left">2016-08-15</time><ul class="tags left"></ul><ul class="tags right"></ul></div><div class="markdown-body"><p>本文仅是对特定射频卡（RFID卡）在技术上的简单探究，请勿以此用作非法用途。</p>
<p>本次研究的RFID卡是Mifare1 S50卡(1K容量)，符合ISO / IEC 14443型标准，其在国内比较常见，是由恩智浦公司（NXP）开发生产，亦有国产的兼容卡。</p>
<h2 id="简介">简介</h2><p>这种卡片的就像一个强制加密的硬盘，密码和数据都存在硬盘里面，厂家出厂会把密码设置默认密码，FFFFFFFFFFFF。<br>其中一共有16个扇区，就像硬盘被分成了16个区，每个区都有独立的两个密码来管理，分别是A密码和B密码。两个密码的权限由控制位决定，一般情况只用A密码便能读写数据。另外有些控制位更改了后就不可逆转。<br>每个扇区又有四个块，就像一个分区面有四个文件一样，如下图。 <img src="http://bbs.eeworld.com.cn/data/attachment/forum/month_1111/20111128_d8c43086bb1d6f115c21WBuWqk0ddCSx.jpg.thumb.jpg" alt=""></p>
<p>扇区0的块0为制造商使用，并不可以更改，其中前4字节为卡片的UID，无需密码可读。（有一种国产M1卡可改UID，在国内叫UID卡，在国外叫 Chinese Magic Card 中国魔术卡）</p>
<h2 id="漏洞">漏洞</h2><p>1.<code>PRNG漏洞</code> ：通过PRNG漏洞攻击，可获得0扇区密匙。</p>
<blockquote>
<p>国外的安全研究人员发现，MIFARE Classic采用的是Crypto-1私有加密算法，其算法的特点就是对称式的密码算法或者说是私钥密码系统。其主要组成部分是伪随机数发生器（PRNG）、48位的线性反馈移位寄存器（LFSR）以及非线性函数。由于算法当中的Filter Function的设计出现缺陷，导致改变线性反馈移位寄存器的后8位数值就有可能得到所对应的Keystream。这个缺陷类似于802.11b WEP算法，不同的明文有极高的可能性被相同的Keystream，使得整个加密算法出现了漏洞。</p>
</blockquote>
<p>2.<code>嵌套认证漏洞</code> ：使用任何一个扇区的已知密匙，获取所有扇区的密匙。</p>
<blockquote>
<p>已知一个扇区的密钥，可以根据漏洞得到其它密钥的32位，然后对其它16位进行穷举攻击，该穷举耗时很短。</p>
</blockquote>
<p>3.<code>通信嗅探</code> ：通过监听卡片和读卡设备的通讯获得密钥。</p>
<blockquote>
<p>M1卡在读卡机和卡片交互数据和密码时，使用了crapto1算法。即便同一张卡，同样的密码，嗅探得到交互数据也是随机的，但是只要获得前面提到的四组随机数组，以及UID，就可以反解出密匙。</p>
</blockquote>
<p>由于水平有限，漏洞的详细原理不叙述，感兴趣请自行搜索相关论文。:D</p>
</div><div data-title="对某种射频卡的简单安全探究" data-url="http://blog.cosimahan.com/对某种射频卡的简单安全探究.html" class="ds-thread"></div></article></div><div class="block-sidebar column one-fourth"><div class="widget archives"><ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/04/">四月 2018</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/03/">三月 2018</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/10/">十月 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/09/">九月 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/08/">八月 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/06/">六月 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/05/">五月 2016</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/04/">四月 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/03/">三月 2016</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/02/">二月 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/12/">十二月 2015</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/11/">十一月 2015</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/09/">九月 2015</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/08/">八月 2015</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/07/">七月 2015</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/04/">四月 2015</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/02/">二月 2015</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/12/">十二月 2014</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/06/">六月 2014</a><span class="archive-list-count">1</span></li></ul></div><div class="widget text-content"></div><div class="widget text-content"><p>Host by <a href="https://github.com">Github</a>.<p></p>Power by <a href="http://hexo.io">Hexo</a>.<p></p>Theme by <a href="https://github.com/jysperm/hexo-theme-simpleblock">Simpleblock</a>.<p></p>License: &nbsp;<a href="http://creativecommons.org/licenses/by-nc-sa/3.0/cn">CC BY-NC-SA 3.0</a>.<p></p>&copy; 2018 <a href="http://blog.cosimahan.com">Cosima Han</a>.</p></div></div></div></div><script>window.duoshuoQuery = {short_name: 'zaq12wsde'}</script><script src="//static.duoshuo.com/embed.js"></script></body></html>